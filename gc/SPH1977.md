*注*：1、[原文链接](http://articles.adsabs.harvard.edu/full/1977MNRAS.181..375G)

2、[LaTeX 数学符号和公式]([https://wulc.me/2016/09/18/%E5%B8%B8%E7%94%A8%E6%95%B0%E5%AD%A6%E7%AC%A6%E5%8F%B7%E7%9A%84%20LaTeX%20%E8%A1%A8%E7%A4%BA%E6%96%B9%E6%B3%95/](https://wulc.me/2016/09/18/常用数学符号的 LaTeX 表示方法/)) 、[标点符号](https://www.jianshu.com/p/e74eb43960a1)

**摘要**：对于天体物理问题，需要一种允许少量点的合理精度的数值方法。理想情况下，编程和健壮也应该很简单。 Pasta＆Ulam（1959）提出了早期尝试提供标准有限差分方法的替代方法。他们用虚拟的粒子组替换了连续的流体，粒子间的力被设计成模仿真实的压力和其他体力。该方法的缺点是讨论了适用于任意维数空间的新的流体动力学代码，并应用于各种多向性恒星模型。该方法的主要特征是使用统计技术从已知的流体元素分布中恢复物理变量的解析表达式。运动方程采用牛顿方程的粒子形式。从三维中大约80个粒子的非轴对称分布开始，该方法被发现将均匀旋转和磁性多边形的结构再现到几个百分之内。可以容易地扩展该方法以处理更复杂的物理模型。难以正确地包括传输过程。

#### 1引言

​	天体物理学中许多最有趣的问题涉及具有大的球对称偏差的系统。这可能是因为初始状态缺乏球形对称性，如从密集的星际云形成的原恒星的情况，或者因为旋转或磁场产生的非球形力，如旋转星的裂变情况，在动态中发挥重要作用。通常会发现这些非球对称的来源。  

​	由于这些系统的复杂性，数值方法需要遵循它们的发展。然而，连续体方程的标准有限差分表示是有限的用途，因为在相等的基础上处理每个坐标需要非常大量的网格点。例如，如果沿径向方向的20个点给出球形多边形的足够精度，我们可能需要（20）3个这样的点来为高度扭曲的多边形提供相同的精度。这种困难反映在多重积分的评估中。

​	对于天体物理问题，需要一种允许少量点的合理精度的数值方法。理想情况下，编程和健壮也应该很简单。 Pasta＆Ulam（1959）提出了早期尝试提供标准有限差分方法的替代方法。他们用虚拟的粒子组替换了连续的流体，粒子间的力被设计成模仿真实的压力和其他体力。这种方法的缺点是传输过程很难正确包含。

​	更好的方法是利用拉格朗日描述的流体流动，自动将注意力集中在流体元素上。在离散版本中，由于压力梯度和其他体力：重力，旋转和磁力，流体包裹根据牛顿方程移动。我们分析的核心特征是我们用来确定流体元件当前位置的力的方法。

 	对于质量相等的流体元件，每单位体积的数量必须与密度成比例。此外，除非从一开始就引入特殊的对称性，否则元件的位置将是随机的，因为大型7V体系统不可避免地需要复杂的运动。因此，我们假设在任何时候，流体元件的位置根据密度随机分布。然后，从已知的元素分布中恢复密度等同于从样本中恢复概率分布。统计学家已经给出了两种方法，这些方法非常适合流体问题。第一种是平滑核方法（Bartlett 1963; Parzen 1962），第二种是delta样条技术（Boneva，Kendall和Stepanov，1971）。两种方法都可以被认为是根据蒙特卡罗程序确定的积分的近似值。由于已知蒙特卡罗方法对多个积分的合理估计具有比有限差分方法通常需要的更少的点，因此如果使用统计平滑方法，则期望减少工作是合理的。我们称这种方法为平滑粒子流体动力学（SPH）。

 	在本文中，我们首先详细描述平滑方法，并建立指导平滑内核选择的条件。然后通过从具有运动方程中的阻尼项的初始非球形配置放松来研究静态球形多边形。然后检查多边形的自由非球面振荡。最后确定了由多边形中均匀旋转和磁场产生的球对称性的偏差，并与微扰理论的结果进行了比较。

 

#### 2 密度分布和体力

##### 2.1密度分布

体积$\Delta v_j$，质心$r_j$和密度$p_j$的流体的第j个元素的运动方程为
$$
\rho_j\Delta v_j\frac{d^2r_j}{dt^2} = -\Delta v_j\nabla P+\rho_j\Delta v_jF_j,	\tag{2.1}
$$
或者
$$
\frac{d^2r_j}{dt^2} = -\frac{1}{\rho_j}\nabla P+F_j,	\tag{2.2}
$$
其中$F_j$是作用在流体元素上的体力，$\nabla P$是$r_j$处的压力梯度。因为在我们的近似中，流体元素是由一个点动态描述的，我们称之为粒子，（2.2）第三粒子的运动方程。

通过考虑从一组点计算平滑密度来开始我们的分析是方便的，变量$r_j$根据密度分布。在Parzen（1962）之后，我们考虑平滑密度$p_s(r)$的定义为
$$
\rho_s(r) = \int W(r-r')\rho(r')dr',	\tag{2.3}
$$
其中W函数满足
$$
\int W(r)dr = 1,	\tag{2.4}
$$
作为所有空间的整合。

如果$\rho(r')$未知，就无法估算(2.3)，但是如果我们有按照$\rho$分布的N个点的集合，就可以通过蒙特卡罗（Hammersley＆Handscomb 1964）方法评估积分。因此，将$\rho_N(r)$定义为
$$
\rho_N(r) = {M\over N}\sum^N_{j=1}W(r-r_j),	\tag{2.5}
$$
其中
$$
M = \int\rho(r)dr,	\tag{2.6}
$$
我们发现，用E表示期望
$$
E[\rho_N(r)] \equiv \frac{1}{M^N}\int...\int\rho_N(r)\prod^N_{i=1}\rho(r_i)dr_i = \rho_s(r).	\tag{2.7}
$$
在我们的数值程序中，每次只产生一个样本分布。因此，等式（2.7）被理解为暗示如果我们要创建一个模型集合，每个模型以不同的点数组开始，与初始条件一致，那么$\rho_N (r)$的集合平均值将是$\rho_s(r)$。

​	用$\rho_N (r)$代替$\rho_s(r)$所引起的误差是$\pm\sigma$，其中$\sigma$定义为
$$
\sigma^2 = E[(\rho_N(r)-\rho_s(r))^2] \\
\Doteq \frac{M^2}{N^2}\sum_jW^2(r-r_j)-\frac{1}{N}[\frac{M}{N}\sum_jW(r-r_j)]^2		\tag{2.8}
$$
为了完成分析链，有必要表明总是可以选择$W(r)$，以便随着N的增加，$\rho_s(r)$变得更接近$\rho (r)$。我们在下一节中证明这个结果。

##### 2.2 选择内核$W(r)$

直观地，当N变大时，认为$W (r)$可以更像$\delta(r)$似乎是合理的。如果是这样的话
$$
\rho(r)\to\rho(r)\:as\:N\to\infty.
$$
为了使这个结果更精确，可以将$W(r)$写作如下形式
$$
W(r)=\frac{1}{h^3}K(r/h),	\tag{2.9}
$$
其中$h$是长度维度的参数，并且假设空间是三维的。通过对Parzen（1962）的一个定理的简单推广，我们发现如果
$$
h\to0\:as\:N\to\infty
$$
并且如果$K(u)$是一个Borel函数，满足
$$
\int K(u)du = 1,|u^2K(u)|\to 0\: as \: |u|\to\infty,\int|K(u)|du<\infty
$$
其中积分在所有空间成立，那么
$$
\rho_N(r)\to\rho(r)\:as\: N\to\infty.
$$
这表明选择$W(r)$作为偶函数是很方便的。三维内核函数的典型示例是
$$
(i)(\frac{1}{\pi h^2})^{3/2}exp(-r^2/h^2)\:\:(ii)\frac{3H(1-|r|/h)}{4\pi h^3}\:\: (iii)\frac{S(|r|/h)}{h^3}	\tag{2.10}
$$
其中$H$是Heaviside阶跃函数，$S$是附录1中讨论的球面delta样条。（2.10）中的每个函数都是表示delta函数的函数序列的成员。

​	除了要求$\rho_N(r)\to\rho(r)$之外，我们还要求$\sigma $应尽可能小。为了满足这些条件，我们通过最小化功能来选择$h$
$$
L(r) = \{E[\rho_N(r)]-\rho(r)\}^2+E[(\rho_N(r)-\rho_s(r))^2]\\
=E[(\rho_N(r)-\rho(r))^2].	\tag{2.11}
$$
利用（2.5）我们发现