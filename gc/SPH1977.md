*注*：1、[原文链接](http://articles.adsabs.harvard.edu/full/1977MNRAS.181..375G)

2、[LaTeX 数学符号和公式](https://wulc.me/2016/09/18/常用数学符号的 LaTeX 表示方法/) 、[标点符号](https://www.jianshu.com/p/e74eb43960a1)



### 光滑粒子流体动力学：理论与非球形星体实践
**摘要**：一个适用于任意数量维度空间的新流体动力学代码被讨论和应用于各种多向星体模型。该方法的主要特征是使用统计技术从已知的流体元素分布中获取物理变量的解析表达式。运动方程采用牛顿方程的粒子形式。从三维中大约80个粒子的非轴对称分布开始，将匀速旋转和磁性多边形的结构再现，偏差在几个百分点之内。该方法容易扩展以处理更复杂的物理模型。

#### 1引言

​	许多最有趣的天体物理学问题都涉及与球对称有巨大偏差的系统。这可能是因为初始状态缺乏球对称性，如由密集的星际云到形成星体，也可能是因为旋转或磁场产生的非球形力在运动过程中发挥重要作用，如旋转星的裂变。这些非球对称的因素通常会交织在一起。  

​	由于这些系统的复杂性，数值方法需要适应它们的发展。然而，标准有限差分对于连续体方程的表示作用是有限的，因为在相等的基础上处理每个坐标需要非常大量的网格点。例如，如果沿射线方向的20个点给出了球形多边形的足够精度，我们可能需要$(20)^3$个这样的点来为高度扭曲的多边形提供相同的精度。这种困难反映在多重积分的计算中。

​	对于天体物理问题，需要一种少量点就可以表示合理精度的数值方法。理想情况下，还应该容易编程且具有鲁棒性。Pasta＆Ulam（1959）在早期尝试提出了这样一个标准有限差分方法的可替代方案。他们用一个虚拟的粒子集合替代了连续的流体，粒子间的作用力用来模拟真实的压力和其他体力。这种方法的缺点是传递过程很难被正确地考虑进来。

*注：体力，是指作用在物体的每个部分上的力，如重力、电磁力；另外一种力称作表面力，比如摩擦力、牵引力*

​	更好的方法是利用拉格朗日描述的流体流动，自动将注意力集中在流体元素上。在离散版本中，由于压力梯度和其他体力：重力，旋转和磁力，流体块根据牛顿方程移动。我们分析的核心问题是采用何种方法来确定流体元素当前位置上的作用力。

 	对于质量相等的流体元素，每单位体积的粒子数量必须与密度成比例。此外，除非从一开始就引入特殊的对称性，否则元素的位置将是随机的，因为在大型N体系统中复杂的运动是不可避免的。因此，我们假设在任何时候，流体元素的位置根据密度随机分布。然后，从已知的元素中获取密度分布等同于从样本中获取概率分布。统计学家已经给出了两种方法，这些方法非常适合流体问题。第一种是平滑核方法（Bartlett 1963; Parzen 1962），第二种是delta样条技术（Boneva，Kendall和Stepanov，1971）。两种方法都可以被认为是根据蒙特卡罗程序确定的积分的近似值。由于已知蒙特卡罗方法通常比有限差分方法需要更少的点就可以给出对多重积分的合理估计，因此如果使用统计平滑方法，则可以期望减少工作量。这种方法我们称之为平滑粒子流体动力学（SPH）。

 	在本文中，我们首先详细描述平滑方法，以及如何根据设立条件选取平滑核。接着研究了静态球形多边形，这些多边形从非球形对称的初始状态被释放，并在运动方程中假如了阻尼项。然后测试了多边形的自由非球面振荡。最后确定了由均匀旋转和多边形内部磁场产生的与球对称之间的偏差，并与微扰理论的结果进行了比较。

 

#### 2 获取分布和体力

##### 2.1密度分布

具有体积$\Delta v_j$，重心$r_j$和密度$\rho_j$的流体的第j个元素的运动方程为
$$
\rho_j\Delta v_j\frac{d^2r_j}{dt^2} = -\Delta v_j\nabla P+\rho_j\Delta v_jF_j,	\tag{2.1}
$$
或者（两边同时除以$\rho_j\Delta_j$）
$$
\frac{d^2r_j}{dt^2} = -\frac{1}{\rho_j}\nabla P+F_j,	\tag{2.2}
$$
其中$F_j$是作用在流体元素上的体力，$\nabla P$是$r_j$处的压力梯度。因为在我们的近似中，流体元素是由一个点动态描述的，我们称之为粒子，（2.2）是第$j$个粒子的运动方程。

​	为了方便开始我们的分析，考虑从一组点计算平滑密度，变量$r_j$根据密度分布。按照Parzen（1962）的方法，我们考虑将平滑密度$\rho{}_s(r)$的定义为
$$
\rho_s(r) = \int W(r-r')\rho(r')dr',	\tag{2.3}
$$
其中函数$W$满足条件
$$
\int W(r)dr = 1,	\tag{2.4}
$$
其中积分包含所有空间。

​	如果$\rho(r')$未知，就无法估算(2.3)，但是如果我们有按照$\rho$分布的N个点（$r_1,r_2,...,r_N$）的集合，就可以通过蒙特卡罗（Hammersley＆Handscomb 1964）方法评估积分。因此，将$\rho_N(r)$定义为
$$
\rho_N(r) = {M\over N}\sum^N_{j=1}W(r-r_j),	\tag{2.5}
$$
其中
$$
M = \int\rho(r)dr,	\tag{2.6}
$$
用$E$表示期望，我们发现
$$
E[\rho_N(r)] \equiv \frac{1}{M^N}\int...\int\rho_N(r)\prod^N_{i=1}\rho(r_i)dr_i = \rho_s(r).	\tag{2.7}
$$
​	在我们的数值程序中，每次只产生一个样本分布。因此，等式（2.7）意味着，如果我们要创建一个模型的集合，每个模型以互不相同且初始条件一致的点集开始，那么$\rho_N (r)$的集合平均值将是$\rho_s(r)$。

​	用$\rho_N (r)$代替$\rho_s(r)$带来的误差是$\pm\sigma$，其中$\sigma$定义为
$$
\sigma^2 = E[(\rho_N(r)-\rho_s(r))^2] \\
\Doteq \frac{M^2}{N^2}\sum_jW^2(r-r_j)-\frac{1}{N}[\frac{M}{N}\sum_jW(r-r_j)]^2		\tag{2.8}
$$
​	为了使分析链完整，有必要证明随着N的增加，总是能找到一个函数$W(r)$，使得$\rho_s(r)$更逼近$\rho (r)$。我们在下一节中实现这一结论。

##### 2.2 选择核函数$W(r)$

直观地，当N变大时，认为$W (r)$可以更像$\delta(r)$似乎是合理的。如果是这样的话
$$
\rho{}_s(r)\to\rho(r)\:当\:N\to\infty.
$$
为了使这个结果更精确，可以将$W(r)$写作如下形式
$$
W(r)=\frac{1}{h^3}K(r/h),	\tag{2.9}
$$
其中$h$是长度维度的参数，并且假设空间是三维的。通过对Parzen（1962）的一个定理的简单推广，我们发现如果
$$
h\to0\:当\:N\to\infty
$$
并且如果$K(u)$是一个Borel函数，且满足
$$
\int K(u)du = 1,|u^2K(u)|\to 0\: 当 \: |u|\to\infty,\int|K(u)|du<\infty
$$
其中积分在所有空间成立，那么
$$
\rho_N(r)\to\rho(r)\:当\: N\to\infty.
$$
这表明可以很方便地选择$W(r)$作为偶函数。三维内核函数的典型示例是
$$
(i)(\frac{1}{\pi h^2})^{3/2}exp(-r^2/h^2)\:\:(ii)\frac{3H(1-|r|/h)}{4\pi h^3}\:\: (iii)\frac{S(|r|/h)}{h^3}	\tag{2.10}
$$
其中$H$是Heaviside阶跃函数，$S$是附录1中讨论的球面delta样条。（2.10）中的每个函数都是表示delta函数的函数序列的成员。

​	除了要求$\rho_N(r)\to\rho(r)$之外，我们还要求$\sigma $应尽可能小。为了满足这些条件，我们通过最小化功能来选择$h$
$$
L(r) = \{E[\rho_N(r)]-\rho(r)\}^2+E[(\rho_N(r)-\rho_s(r))^2]\\
=E[(\rho_N(r)-\rho(r))^2].	\tag{2.11}
$$
利用（2.5）我们发现
$$
L(r)=\frac{M}{N}\int W^2(r-r‘)\rho(r')dr'+(1-\frac{1}{N})[\int W(r-r')\rho(r')dr']^2\\
+\rho^2(r)-2\rho(r)\int W(r-r')\rho(r')dr'.			\tag{2.12}
$$
由于$W(r-r')$在$r = r'$处达到绝对峰值，我们可以将$\rho (r')$扩展到$r$。只保留主导元素，我们发现
$$
L(r)\thicksim\frac{M}{N}\rho(r)\int W^2(r')dr'+\{\frac{\nabla^2\rho}{6}\int W(r')r'^2dr'\}^2.	\tag{2.13}
$$
利用（2.9）发现$L(r)$有最小值，当
$$
h^7 = \frac{27}{N}\frac{M\rho}{(\nabla^2\rho)^2}\frac{\int K^2(u)du}{\{\int K(u)u^2du\}^2}		\tag{2.14}
$$
因为$\rho$未知，（2.14）不能直接使用，除非推断
$$
h\varpropto 1/N^{1/7}\:且 \: L_{min}\varpropto1/N^{4/7}.
$$
我们找到一个合适的$h$取值
$$
h = b(\langle r^2\rangle-\langle r\rangle^2)^{1/2},		\tag{2.15}
$$
其中$\Beta$是可调节的，并且
$$
\langle c(r)\rangle = \frac{\int \rho cdr}{M}\Doteq\frac{1}{N}\sum_jc(r_j).
$$
​	在我们考虑的问题中，平滑函数的导数需要是连续的。因此，（2.10）中的第二个内核函数不能用。在其他可能的内核函数中，我们专注于高斯函数和样条函数。

​	为了在高斯和样条内核之间做出选择，我们采用已知的分布并分配一组点。然后为$\Beta$的各种取值评估吻合度$[\rho_N(r)-\rho(r)]^2$。40个点情况下，两个核函数之间的差异可以忽略不计，但对于80个点，高斯更准确。出于这个原因，我们更青睐高斯核，并使用高斯核。

​	对于我们的星体模型，我们通过寻求平滑粒子模型对于已知密度的球对称静水模型的吻合度来选择$\Beta$。也可以选择使用更复杂的程序，但我们发现对于所要考虑的模型来说这些函数可以说是成功的。

##### 2.3 重力场

​	我们使用如下定义的重力场$\phi$
$$
\phi = -G\int\frac{\rho_N(r')dr'}{|r-r'|}.		\tag{2.16}
$$
利用（2.5）
$$
\phi=-\frac{GM}{N}\sum^N_{j=1}\int \frac{W(r'-r_j)dr'}{|r-r'|}.		\tag{2.17}
$$

$$
I_j=\int\frac{W(r'-r_j)dr'}{|r-r'|},		\tag{2.18}
$$

如果注意到下面这一点，上式可以容易地计算
$$
\nabla^2I_j=-4\pi W(r-r_j).		\tag{2.19}
$$
我们发现
$$
\nabla\phi = -\frac{GM}{N}\sum^N_{j=1}\{-\frac{4\pi}{u_j^2}\int^{u_j}_0W(u)u^2du\}\nabla u_j,		\tag{2.20}
$$
其中
$$
u_j = r-r_j.
$$
​	由于高斯函数的$W$由(2.10)(i)使用$f=1/h^2$定义，所以
$$
\nabla \phi = -\frac{GM}{N}\sum^N_{j=1}\frac{2}{u_j}(\frac{f}{\pi})^{1/2}[exp(-fu_j^2)-\frac{1}{u_j}\int^{u_j}_0exp(-fu^2)du]\nabla u_j		\tag{2.21}
$$
并且
$$
I_j=\frac{2}{u_j}(\frac{f}{\pi})^{1/2}\int^{u_j}_0exp(-fu^2)du.
$$
​	delta样条核函数$W$的等效公式引入了多项式，并且更容易计算。

##### 2.4 一般分布

​	为了找到任何其他标量（或矢量）字段$A(r)$的平滑版本，我们定义平滑字段$A_s(r)$
$$
A_s(r)=\int W(r-r')A(r')dr',		\tag{2.22}
$$
其中，一般来讲，核函数与（2.3）不同。$A_s(r)$的计算为
$$
A_N(r)=\frac{M}{N}\sum^N_{j=1}W(r-r')\frac{A(r_j)}{\rho(r_j)}.		\tag{2.23}
$$
这样计算的误差值为$\pm\sigma$，其中
$$
\sigma^2=\frac{M^2}{N^2}\sum_jW^2(r-r_j)\frac{A^2(r_j)}{\rho^2(r_j)}-\frac{1}{N}A_N^2.		\tag{2.24}
$$
​	当$A(r)$与密度类似地分布时，所引入的近似值变得更好。这是温度和熵的情况，但对于磁场，通常不适用。为了处理这种情况，重要性抽样被证明是很有用的，并且我们将在下一小节中讨论它的应用。在场具有已知对称性的情况下，可以使用对立变量来提高精度。

##### 2.5 磁场和电流

​	根据2.4节中给出的公式，磁场的计算由下式给出
$$
\Beta_N(r)=\frac{M}{N}\sum^N_{j=1}W(r-r_j)\frac{\Beta_j}{\rho_j},		\tag{2.25}
$$
并且电流的计算如下
$$
J_N(r)=\epsilon_0c^2\frac{M}{N}\sum_j\nabla{W}\times\frac{\Beta_j}{\rho_j}.		\tag{2.26}
$$
​	然而，通常情况下在星体内部和外部存在场，并且（2.25）是对$\Beta_s(r)$的一个差劲的近似值，（2.26）则是对$J_s(r)$的更烂的近似值。为了改进近似值，我们在公式中使用重要性采样（Hammersley＆Handscomb 1964）
$$
\Beta_s(r)=\Beta_0(r)+\int{W}(r-r')[B(r')-\Beta_0(r')]dr',		\tag{2.27}
$$
其中$B_0(r)$是$\Beta(r)$的一个近似值。为了获得这个近似值，我们求解
$$
\epsilon_0c^2\nabla\times{\Beta}_0=J_N(r),		\tag{2.28}
$$
使用如下公式
$$
\Beta_0=\Beta_{ext}+\frac{1}{4\pi\epsilon_0c^2}\int\frac{J_N(r)\times(r-r')dr'}{|r-r'|^3},		\tag{2.29}
$$
其中$\Beta_{ext}$是任何叠加的外场。例如，它可能是贯穿正在生成该星体的星际云的场。将（2.26）代入（2.29）我们发现
$$
\Beta_0(r)=\Beta_{ext}-\frac{M}{4\pi{N}}\sum^N_{j=1}[(\frac{\Beta_j}{\rho_j}\cdot\frac{\partial}{\partial_r})\frac{\partial{I}_j}{\partial{r}_j}-\frac{4\pi}{\rho_j}\Beta_jW(r-r_j)],		\tag{2.30}
$$
其中$I_j$由（2.18）定义。

​	鉴于高斯核(2.10)(i)函数$f=1/h^2$，近似值变成了
$$
\Beta_0(r)=\Beta_{ext}+\frac{M}{N}\sum_j(\frac{f}{\pi})^{3/2}\{\begin{array}\frac{\Beta_j}{\rho_j}[exp(-fu^2)-\frac{1}{u^3}\int^u_0exp(-fv^2)v^2dv]\\+u(\frac{\Beta_j\cdot{}u}{\rho_ju})[\frac{3}{u^4}\int^u_0exp(-fv^2)v^2dv-\frac{exp(-fu^2)}{u}]\end{array}\}		\tag{2.31}
$$
其中$u=u_j=r-r_j.$

​	我们使用属性
$$
\Beta_N(r)=\Beta_0(r)+\frac{M}{N}\sum_j\frac{W(r-r_j)}{\rho_j}\{\Beta(r_j)-\Beta_0(r_j)\}		\tag{2.32}
$$
并且从（2.32）获取电流。因此
$$
J_N(r)=\frac{\epsilon_0c^2M}{N}\sum_j\frac{\nabla{}W}{\rho_j}\times\{2\Beta(r_j)-\Beta_0(r_j)\}+J_{ext(r)},		\tag{2.33}
$$
其中$j_{ext}$是与$\Beta_{ext}$相关的当前电流。稍候我们会介绍，这个程序很好的模拟了电流和磁场。

##### 3 运动方程

​	具有内部磁场$ \Beta$、指数$n$的均匀旋转多边形的流体颗粒的运动方程为
$$
\frac{d^2r_j}{dt^2}=-\Gamma\frac{dr_j}{dt}-K\rho^{1/n-1}_j\frac{(1+n)}{n}\nabla\rho-\nabla\phi-\Omega\times(\Omega\times{r})-2\Omega\times\frac{dr_j}{dt}+\frac{J\times\Beta}{\rho},j=1,2,...,N		\tag{3.1}
$$
其中压力$P=K\rho^{1+1/n}$，$\Omega$是角速度，$\Beta$为磁场，$J$为电流。引入阻尼项$\Gamma{}dr_j/dt$以允许计算静态模型。对于此处考虑的旋转模型，仅需要静态结构，并且可以丢弃Coriolis项。无量纲变量$x_j,D,\tau,b$定义如下  
$$
\rho=\lambda{D},\:r_j=\alpha{x}_j,\:t=\beta\tau,\:\Beta=Bb		\tag{3.2}
$$
其中
$$
\alpha^2=\frac{(n+1)K\lambda^{1/n-1}}{4\pi{G}},\:\beta^2=\frac{\alpha^2n}{K\lambda^{1/n}(1+n)},		\tag{3.3}
$$

并且$\lambda \:and\: B$可以选取方便的值。丢掉Coriolis项，（3.1）变为
$$
\frac{d^2x_j}{d\tau^2}=-\frac{\gamma dx_j}{d\tau}-D^{1/n-1}_j\nabla D_j-\frac{n}{4\pi}\nabla\Phi-\omega^2i\times(i\times x_j)+\eta\frac{(\nabla\times b)\times b}{D_j},		\tag{3.4}
$$
其中，$\gamma$是一个新的阻尼常量
$$
\Omega=(\frac{4\pi G\lambda}{n})^{1/2}\omega i,\:\eta=\frac{\epsilon_0c^2nB^2}{4\pi G\lambda^2\alpha^2},		\tag{3.5}
$$
$\Phi$是可缩放的重力场，满足
$$
\Phi=\frac{\phi}{G\lambda\alpha^3}=\frac{\phi Q}{GM}
$$
并且我们已经选择了$Q=\int D(x)dx$，确切的说，像第2节中那样用求和表示积分，然后$D(0)$会等于1，而$ \lambda $是中心密度。因此，我们的缩放变量类似于通常的多元变量（Chandrasekhar 1939）。然而，因为在我们的模型中$D(0)\ne1$，我们的长度因子与多元变量相关$\xi\:by\:\xi=D(0)^{(n-1)/2n}|x|$.

​	这里考虑的模型，磁通量变化是在通量（freezing？）近似中计算

$$
\frac{d}{dt}(\frac{B}{\rho})=(\frac{B}{\rho}\cdot\nabla)v,		\tag{3.6}
$$
其中$d/dt$是跟随运动的衍生物。为了将该等式向前积分，我们用平滑的速度场代替$v$。公式（3.6）的优点是它可以自动生成每个流体元素所需的$B/\rho$量，以产生平滑的场。

#### 4 数值试验 - 球形模型

##### 4.1 静态模型构建

​	为了构建静态模型，我们按照初始的位置分布和速度等跟随粒子集的阻尼运动，直到系统停止。通常，颗粒最初处于静止状态，根据随机高斯分布或者按照在球对称立体网格分布在空间中。在前一种情况下，调整粒子的初始坐标，使得质心位于坐标系的中心。作为检查，在计算过程中监测重心的位置和速度。

​	对于初始配置具有不同阻尼系数的两个指数为1的多边形的平衡路径在图1中给出。实线表示作为缩放时间$\tau$的函数$D(0)$的行为，即按照立体网格分布的33个粒子，阻尼$\gamma=0.05$条件下生成的序列。虚线显示的是通常围绕原点分布的40个粒子生成的序列，其中$\gamma=0.15$。

​	最终获得的模型看起来几乎与阻尼、初始配置和粒子数量无关。当然，这些模型序列开始时具有很好的球对称性。相当不规则的初始分布也可以被成功地处理。图2（a）给出了初始状态为非球对称分布的指数1的多边形在$(X,Y)$平面上的密度分布，其最终形成了图2（b）所示的对称分布。

##### 4.2 静态结构

​	使用约40个粒子和宽范围的平滑常数b（由方程式2.15定义）构建的指数1和1.5的多边形的密度分布被发现与星体大部分真实密度分布匹配偏差在几个百分点之内（？）。然而，指数为1的多边形的多变半径的最外10％的密度分布反映了平滑函数的性质，而不是实际的物质分布。通过使用更多数量的粒子可以使该区域变得更小。

​	以高度球对称性开始的序列产生类似的高度对称的多边形。在其他情况下，球形对称的偏离不到2％

​	指数为2.5的多边形也可以一定数量的粒子和平滑常数b来构造。在图3中，我们显示了两个这样的模型的适当规模的密度分布。曲线表示的真实密度，而实心圆表示用$N=80$构建的模型的密度分布。由于该模型高度对称，因此仅显示了沿一个轴的密度分布。图3中还展示了用一半颗粒构造的模型的较不对称的密度分布。该模型的三个坐标轴中每个点上的点密度范围由垂直条表示。在这种情况下，密度分布比图示中看起来更接近真实密度。沿着每个坐标轴，密度分布非常好，但峰值偏离原始值。尽管如此，通过将粒子数量从40增加到80来实现的改进是显著的，并且超过了我们在蒙特卡罗集成中所期望的$\sqrt{N}$改进。这可能是由于40颗粒子本质上太少了。

​	表1中给出了$n=2.5$的各种模型的一些简要细节。在每种情况下，序列开始于关于原点高斯分布的粒子。尽管$D( 0)$的最终值随平滑参数和粒子数而变化，但在每种情况下，密度分布和$D( 0 )$的比值是相似的。表1中还显示了由下式给出的粒子的均方径向位置
$$
\langle\xi^2\rangle = \frac{1}{N}\sum\xi_j^2 \cong\int\rho\xi^2dv/\int\rho dv.
$$
这些值小于通过使用上述表达式中的密度分布进行积分而获得的值4.8。这种差异并不令人惊讶，因为积分$\xi^4$的最大值超出了大部分粒子的位置。

##### 4.3 无阻尼振荡

​	排除阻尼并跟踪几个流体动力学序列。发现它们以反映模型初始状态的混合模式振荡。在每种情况下，中心密度的主要振荡周期都很明显。这与Kopal（1938）给出的指数n在1-2.5范围内且$N\sim40$的多态的振荡周期匹配偏差小于10个百分点。使用更多粒子可以减少此偏差。在大振幅振荡$(\delta D(0)/D(0)\sim3)$的多个循环的延长运行期间，发现具有$N\sim4 0$的系统的总能量$E$以$|\delta E/E\lesssim0.1|$振荡。该误差与根据蒙特卡罗程序用求和替换积分一致。

#### 5 数值试验-非球模型

##### 5.1 均匀旋转多边形

研究均匀旋转的多边形，以确定该技术用来再现非球形结构时的精度。

​	在图4中展示了指数为1.5的快速旋转多边形的极坐标和赤道密度分布，其中$\omega^2=0.024$。该图还显示了使用Monaghan＆Roxburgh（1965）的近似技术获得的相同模型的密度分布。很明显，两者有很好的一致性。所有模型关于旋转轴和赤道都是对称的，偏差在5％以内。

​	因为我们的模型没有$D(0)=1$，所以Monaghan和Roxburgh的参数$\alpha$与我们的$ \omega^2$相关$\alpha=2\omega^2/nD(0)$。因此，所示的模型在分解的边缘。由于我们的方法不会在边缘附近产生流体粒子，因此无法准确确定与分解相对应的$\omega $的临界值。当然，对于更多的粒子，更小的$h$，可以根据需要精确地计算临界$ \omega $。或者，可以引入测试粒子。

##### 5.2 磁性多边形

​	从静态非旋转状态开始然后叠加场来研究具有极向和环向场的多边形的静态结构。允许多边形最终进入稳定状态。因为本研究的主要目的是探索数值方法，我们选择了作为一阶微扰方程的已知解的初始场。采用了Monaghan（1965）的极向场和Roxburgh（1966）的环形场。

​	我们在在图5中展示了x轴上的初始场和电流，它是根据指数为1的多边形中的偶极场的解析表达式计算出来的。还显示了根据第2.5节的程序计算的初始和最终平滑场和电流 。初始场与平滑等效点之间的一致性非常好。我们相信可以通过调整平滑参数或通过对磁场的每个分量采用该参数的不同值来进一步改进。

​	分析平衡场基于一阶扰动分析，该分析假设磁场可以由非扰动密度构建。由于我们发现密度扰动$\sim 10\%$，我们预计最终场与一阶扰动结果的数量不同。因此，图5中所示的初始场和最终场与电流之间的差异并不出乎意料。

​	在图6中，针对本数值计算和一阶扰动结果示出了赤道和极地密度分布。由于我们的模型有$D(0)\ne1$，并且场和电流与分析因子大约相差一个比例因子，因此$\eta $与Monaghan（1965）的因子$\overline\omega$和k之间的关系近似
$$
\overline\omega=\frac{\eta}{nk^2D(0)^{1+1/n}}(\frac{computed\ B_z(0)}{analytical\ B_z(0)})^2.
$$
​	一阶扰动结果与我们的数值结果之间的一致性非常好。由于扰动方法存在误差，可以预期到与未受干扰的密度之间会有偏差10％的微小变化，但这对密度分布的影响可以忽略不计。

​	所研究的环形场在多边形外部为零，并且可以在不使用第2.5节的重要性采样装置的情况下获得令人满意的平滑场。用40个粒子模拟的指数为1的多边形中，初始平滑场重现分析场的偏差$\lesssim5$个百分点。

​	在计算过程中监测磁通量的恒定性，发现其保持恒定，振幅小于2个百分点。

#### 6 计算要求

​	本文中描述的所有序列都存储在IBM 360/165的60-90K字节的核心存储中。典型的$N=40$无磁场序列，每个时间步长需要约0.25秒，每个模型需要约200个时间步长（50秒）。通过计算$h/v_{max},(h/F_{max})^{1/2}和h/D^{1/2n}$的最小值来固定时间步长，其中$v_{max}$是最大粒子速度，$F_{max}$是最大作用力，最后一个标准数值是基于速度声音。然后将最小值乘以常数。如果该常数在0.1-0.5的范围内，则积分稳定而不需要过多的时间。通过在粒子位置存储当前的力和密度，时间可以减半。我们目前正在对导致裂变的动力序列进行计算。对于80粒子配置，这些需要大约四分钟的计算时间。



#### 结论

​	该研究的结果表明，通过使用平滑粒子法这样一种简单的技术，可以模拟振荡的多边形或者从非球形初始状态到最终球形状态的多边形的运动，并给出令人满意的结果。该方法同样可以毫无困难地处理旋转和磁场，并且与扰动结果的比较表明其能够准确地再现适度的扭曲。通过增加粒子数量并使用已知的改进蒙特卡罗积分方法的技巧，总是可以获得更精细或更高精度的结构。

#### 致谢

​	在1976年剑桥天文学研究所的演讲中，Leon Lucy讨论了使用平滑技术进行流体动力学编码。我们的同事将他的想法告知了我们，但本文的数学发展与他的工作无关。





